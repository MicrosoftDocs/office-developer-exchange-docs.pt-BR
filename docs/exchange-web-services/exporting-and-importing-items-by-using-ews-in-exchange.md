---
title: Exportando e importando itens usando o EWS no Exchange
manager: sethgros
ms.date: 03/9/2015
ms.audience: Developer
ms.assetid: ad5f75f9-47c3-4f51-a535-80cba4243683
description: Saiba mais sobre como exportar e importar compromissos, emails, contatos, tarefas e outros itens de caixa de correio usando a API gerenciada do EWS ou o EWS no Exchange.
localization_priority: Priority
ms.openlocfilehash: 1bd36cec5c26f79de96b1506a52d297d2edc051a
ms.sourcegitcommit: 88ec988f2bb67c1866d06b361615f3674a24e795
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 06/03/2020
ms.locfileid: "44528416"
---
# <a name="exporting-and-importing-items-by-using-ews-in-exchange"></a>Exportando e importando itens usando o EWS no Exchange

Saiba mais sobre como exportar e importar compromissos, emails, contatos, tarefas e outros itens de caixa de correio usando a API gerenciada do EWS ou o EWS no Exchange. 
  
O Exchange é uma mina de ouro de informações importantes: email, contatos, tarefas e calendários são fundamentais para as funções de uma organização. O EWS permite que você exporte e importe os tipos de itens principais por meio de três abordagens diferentes:
  
- Tipos de item do Exchange. Recomendamos essa abordagem para importar e exportar itens de e para outros sistemas e arquivos.
    
- Recurso de nível de item (somente EWS). Recomendamos esta opção para exportar ou copiar de um servidor do Exchange ou caixa de correio e importar para outro.
    
- Fluxos MIME na forma de formatos de arquivo padrão comuns, como iCalendar e vCard. Como o conjunto de propriedades é limitado e a conversão MIME é dispendiosa, recomendamos a abordagem apenas para importar ou exportar uma pequena quantidade de dados.
    
> [!IMPORTANT]
> O EWS não foi projetado para backup e restauração de caixa de correio. Para fazer backup e restaurar bancos de dados, use a [API de backup e restauração](../backup-restore/backup-and-restore-for-exchange-2013.md). Consulte também [backup, restauração e recuperação de desastres](https://technet.microsoft.com/library/dd876874%28v=exchg.150%29.aspx) no TechNet. 
  
**Tabela 1. Exportando e importando contatos, email e itens de calendário**

|Tarefa|Método de API gerenciada do EWS|Operação do EWS|Observações|
|:-----|:-----|:-----|:-----|
|Exportar uma cópia de um contato, email, tarefa ou item de calendário com um [conjunto de propriedades especificado](properties-and-extended-properties-in-ews-in-exchange.md).  <br/> |[Contato. bind](https://msdn.microsoft.com/library/microsoft.exchange.webservices.data.contact.bind%28v=exchg.80%29.aspx) <br/> [EmailMessage. bind](https://msdn.microsoft.com/library/microsoft.exchange.webservices.data.emailmessage.bind%28v=exchg.80%29.aspx) <br/> [Compromisso. bind](https://msdn.microsoft.com/library/microsoft.exchange.webservices.data.appointment.bind%28v=exchg.80%29.aspx) <br/> [Task. bind](https://msdn.microsoft.com/library/microsoft.exchange.webservices.data.task.bind%28v=exchg.80%29.aspx) <br/> |[GetItem](https://msdn.microsoft.com/library/e3590b8b-c2a7-4dad-a014-6360197b68e4%28Office.15%29.aspx) <br/> |Recomendamos esta opção se você estiver exportando itens de caixa de correio para outro sistema ou arquivo que não seja do Exchange (incluindo os tipos de arquivo vCard e iCal).<br/>Como você tem controle sobre o conjunto de propriedades exportadas e como o desempenho é melhor para o servidor do Exchange, essa é geralmente a melhor opção.<br/><br/>Dependendo das propriedades definidas em um item de caixa de correio e se o aplicativo está ciente de todos os identificadores de propriedade não esquematizado (propriedades estendidas) que podem ser definidos em um item, essa opção pode não produzir uma cópia de alta fidelidade.<br/><br/>Esses métodos e operação fornecem o conjunto esquematizado de propriedades para um item, além de todas as propriedades estendidas solicitadas.<br/>O método **BIND** ou a operação **GetItem** pode fornecer somente a exportação de itens de fidelidade total se você souber as propriedades estendidas que estão definidas em um item.<br/>Você pode solicitar todas as [Propriedades estendidas](properties-and-extended-properties-in-ews-in-exchange.md) conhecidas para habilitar a fidelidade total.<br/><br/>**Dica**: você pode usar o recurso de rastreamento na API gerenciada do EWS para obter a representação XML dos itens exportados.           Para obter mais informações, consulte [exportar um item para um formato personalizado](how-to-export-items-by-using-ews-in-exchange.md#bk_exportcustom).  <br/> |
|Importe uma cópia de um contato, email, tarefa ou item de calendário com um [conjunto de propriedades especificado](properties-and-extended-properties-in-ews-in-exchange.md).  <br/> |[Contato. Save](https://msdn.microsoft.com/library/microsoft.exchange.webservices.data.contact.save%28v=exchg.80%29.aspx) <br/> [EmailMessage. Save](https://msdn.microsoft.com/library/microsoft.exchange.webservices.data.emailmessage.save%28v=exchg.80%29.aspx) <br/> [Compromisso. Save](https://msdn.microsoft.com/library/microsoft.exchange.webservices.data.appointment.save%28v=exchg.80%29.aspx) <br/> [Task. Save](https://msdn.microsoft.com/library/microsoft.exchange.webservices.data.task.save%28v=exchg.80%29.aspx) <br/> |[CreateItem](https://msdn.microsoft.com/library/78a52120-f1d0-4ed7-8748-436e554f75b6%28Office.15%29.aspx) <br/> |Recomendamos esta opção para importar itens de caixa de correio para o Exchange.<br/>Você pode precisar definir propriedades especiais em alguns tipos de item para manter o estado do item importado.<br/>Como algumas propriedades são definidas pelo Exchange e não por clientes, nem sempre é possível ter uma importação de fidelidade total.<br/><br/>Por exemplo, não é possível importar uma reunião com participantes para uma caixa de correio, pois o Exchange define as relações entre o organizador e os participantes. <br/>Essa relação só pode ser estabelecida por organizadores que enviam e respondem a solicitação de reunião.<br/><br/>Os objetos de **compromisso** no Exchange podem ter relacionamentos e configurações complexos.<br/> Os compromissos com participantes (reuniões) têm configurações que unem o organizador da reunião e os participantes da reunião.<br/>Essas configurações não são mantidas quando você exporta e importa compromissos.<br/>Não há suporte para restabelecer programaticamente relações de organizador/participantes da reunião diretamente nos compromissos.<br/>Uma opção que você precisa para restabelecer essas relações é executar o pós-processamento após uma importação e, em seguida, fazer o organizador reenviar as reuniões e fazer com que os participantes aceitem as reuniões.<br/>Você pode usar a representação do Exchange para fazer as chamadas para o organizador e os participantes.<br/>Você deve alterar a propriedade UID do objeto **compromisso** antes de importar para evitar que as reuniões estejam incorretamente relacionadas a outras reuniões em uma caixa de correio.  <br/> |
|Exportar uma cópia de um contato, email, tarefa ou item de calendário em fidelidade total.  <br/> |Não aplicável  <br/> |[ExportItems](https://msdn.microsoft.com/library/e2846abb-0b16-4732-bbd8-038a674672f6%28Office.15%29.aspx) <br/> |Esta é a melhor opção para exportar itens de caixa de correio que você deseja importar de volta para uma caixa de correio do Exchange.<br/>Você também pode usar essa opção para copiar itens entre caixas de correio.<br/><br/>A operação **ExportItems** fornece um fluxo opaco que representa o item que você pode usar para mover informações entre caixas de correio.<br/>Você pode usar o **ExportItems** com a operação [GetItem](https://msdn.microsoft.com/library/e3590b8b-c2a7-4dad-a014-6360197b68e4%28Office.15%29.aspx) para criar um índice para localizar os itens em outro sistema.<br/>Não é possível alterar o fluxo de exportação.  <br/> Para obter mais informações, consulte [exportar itens com fidelidade total](how-to-export-items-by-using-ews-in-exchange.md#bk_exportfullfidelity).  <br/> |
|Importe uma cópia de um contato, email, tarefa ou item de calendário em fidelidade total.  <br/> |Não aplicável  <br/> |[UploadItems](https://msdn.microsoft.com/library/a88cbe99-7968-454d-a545-4f92c330909f%28Office.15%29.aspx) <br/> |Essa é a única opção para importar itens que foram exportados pela operação **ExportItems** .  <br/> |
|Exportar uma cópia de um contato, email ou item de calendário como um fluxo MIME para um tipo de arquivo comum.  <br/> |[Contato. bind](https://msdn.microsoft.com/library/microsoft.exchange.webservices.data.contact.bind%28v=exchg.80%29.aspx) <br/> [EmailMessage. bind](https://msdn.microsoft.com/library/microsoft.exchange.webservices.data.emailmessage.bind%28v=exchg.80%29.aspx) <br/> [Compromisso. bind](https://msdn.microsoft.com/library/microsoft.exchange.webservices.data.appointment.bind%28v=exchg.80%29.aspx) <br/> |**GetItem** <br/> |Você pode usar a propriedade [MimeContent](https://msdn.microsoft.com/library/microsoft.exchange.webservices.data.item.mimecontent%28v=exchg.80%29.aspx) para obter a representação de fluxo MIME de um item.<br/><br/>Isso fornecerá um subconjunto básico de todas as propriedades de um item.<br/>Como prática recomendada, use apenas o fluxo MIME para operações individuais.<br/>Não confie em MIME para importação/exportação de itens grandes e freqüentes, porque o Exchange realiza a conversão de conteúdo para o MIME e isso pode afetar o desempenho.<br/><br/>O fluxo MIME do **contato** é um arquivo [vCard](http://www.faqs.org/rfcs/rfc2426.html) (. vcf).<br/>Dependendo das propriedades definidas em um contato, isso pode não produzir uma cópia de fidelidade total.<br/>Observe que você não pode importar um contato usando o Stream MIME do vCard.<br/>Para saber mais, confira [exportar um contato para um arquivo vCard](how-to-export-items-by-using-ews-in-exchange.md#bk_exportvcardmime).<br/><br/>O fluxo MIME **EmailMessage** é um arquivo. eml.<br/>O formato. eml é conveniente porque o Outlook e outros clientes de email podem identificá-lo.<br/>Você também pode usar o fluxo MIME para criar um arquivo. mht, que é conveniente porque muitos navegadores podem usar esse tipo de arquivo.<br/>O EWS não fornece um fluxo de arquivo. msg para exportar um email para um arquivo. msg.<br/>Suas opções para exportar um arquivo. msg são [construir um. MSG](https://msdn.microsoft.com/library/cc463912%28v=EXCHG.80%29.aspx) a partir dos resultados de um método **EmailMessage. bind** ou de uma chamada de operação **GetItem** , ou use uma API de terceiros que chame EWS e construa o arquivo. msg dos resultados.<br/>Para obter mais informações, consulte [exportar um email como um arquivo. eml](how-to-export-items-by-using-ews-in-exchange.md#bk_exportemailmime).<br/><br/>O fluxo MIME do **compromisso** é um arquivo iCal (. ICS).<br/>O formato. ics é conveniente porque o Outlook e outros clientes de email podem identificá-lo.<br/>Esta não é uma opção viável para exportar reuniões porque as informações do participante não são fornecidas no fluxo MIME. <br/>Anexos e outras propriedades podem não ser incluídos no fluxo MIME.<br/>Considere construir o formato iCal a partir do objeto de [compromisso](https://msdn.microsoft.com/library/microsoft.exchange.webservices.data.appointment%28v=exchg.80%29.aspx) ou do XML retornado pela operação **GetItem** .<br/>Dessa forma, você pode capturar mais das propriedades do Exchange com propriedades estendidas (Propriedades "X-") no arquivo iCal.<br/>Você também pode exportar um compromisso no formulário XML.<br/>Chame a operação **GetItem** e salve o XML no sistema.<br/>Você também pode usar a [funcionalidade de rastreamento](how-to-trace-requests-responses-to-troubleshoot-ews-managed-api-applications.md) na API gerenciada do EWS para capturar o XML a ser colocado em um banco de dados XML.<br/>Para obter mais informações, consulte [exportando um compromisso como um arquivo iCal](how-to-export-items-by-using-ews-in-exchange.md#bk_exporticalmime).  <br/> |
|Importe uma cópia de um item de email ou de calendário como um fluxo MIME para um tipo de arquivo comum.  <br/> |[EmailMessage. Save](https://msdn.microsoft.com/library/microsoft.exchange.webservices.data.emailmessage.save%28v=exchg.80%29.aspx) <br/> [Compromisso. Save](https://msdn.microsoft.com/library/microsoft.exchange.webservices.data.appointment.save%28v=exchg.80%29.aspx) <br/> |**CreateItem** <br/> |Você pode importar um arquivo. eml ou. ics usando a propriedade **MimeContent** em um objeto **EmailMessage** ou **compromisso** .<br/>Será necessário definir a propriedade estendida [PidTagMessageFlags (0x0E07)](https://msdn.microsoft.com/library/office/cc839733%28v=office.15%29.aspx) se o email não for um rascunho.<br/><br/>Você não pode usar essa abordagem para importar reuniões.  <br/> |
   
## <a name="alternatives-to-exporting-and-importing-items-by-using-ews"></a>Alternativas para exportar e importar itens usando o EWS
<a name="alternatives"> </a>

Outras opções estão disponíveis para o exporing e importando itens de e para uma caixa de correio do Exchange. Veja a seguir algumas ideias a serem consideradas ao criar a estratégia de importação e exportação:
  
- Use o PowerShell para chamar o EWS e formatar a saída em um arquivo. csv.
    
- Use bibliotecas de terceiros que implementam o MAPI para exportar e importar itens. Bibliotecas de terceiros que convertem os arquivos EWS para. msg também estão disponíveis.
    
- Use o Shell de gerenciamento do Exchange e os cmdlets [MailboxImportRequest](https://technet.microsoft.com/library/ff607310%28v=exchg.150%29.aspx) e [MailboxExportRequest](https://technet.microsoft.com/library/ff607299%28v=exchg.150%29.aspx) para atender às [solicitações de importação e exportação de caixa de correio](https://technet.microsoft.com/library/ee633455%28v=exchg.150%29.aspx). 
    
- Use [as opções de importação do Outlook](https://office.microsoft.com/outlook-help/import-outlook-items-from-an-outlook-data-file-pst-HA102505743.aspx) para importar e exportar itens. 

    
## <a name="in-this-section"></a>Nesta seção
<a name="alternatives"> </a>

- [Exportar itens usando o EWS no Exchange](how-to-export-items-by-using-ews-in-exchange.md)    
- [Importar itens usando o EWS no Exchange](how-to-import-items-by-using-ews-in-exchange.md)
    
## <a name="see-also"></a>Confira também

- [Backup, restauração e recuperação de desastre](https://technet.microsoft.com/library/dd876874%28v=exchg.150%29.aspx)  
- [Registro no diário](https://technet.microsoft.com/library/aa998649%28v=exchg.150%29.aspx)    
- [Especificação de objeto principal de calendário e agendamento da Internet (RFC 5545)](http://tools.ietf.org/html/rfc5545)   
- [Sincronização de caixa de correio e EWS no Exchange](mailbox-synchronization-and-ews-in-exchange.md)
    