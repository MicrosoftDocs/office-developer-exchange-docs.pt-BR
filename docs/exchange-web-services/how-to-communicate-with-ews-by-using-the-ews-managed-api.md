---
title: Comunicar-se com o EWS usando a API gerenciada de EWS
manager: sethgros
ms.date: 09/17/2015
ms.audience: Developer
localization_priority: Normal
ms.assetid: d1b78293-da02-413a-875c-681e99146af3
description: Encontre informações sobre como usar a API gerenciada de EWS para se comunicar com o EWS no Exchange.
ms.openlocfilehash: 773fcc3f7e95d25effb5a686d4b79ec22610df8c
ms.sourcegitcommit: 34041125dc8c5f993b21cebfc4f8b72f0fd2cb6f
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 06/25/2018
ms.locfileid: "19750705"
---
# <a name="communicate-with-ews-by-using-the-ews-managed-api"></a><span data-ttu-id="dfa41-103">Comunicar-se com o EWS usando a API gerenciada de EWS</span><span class="sxs-lookup"><span data-stu-id="dfa41-103">Communicate with EWS by using the EWS Managed API</span></span>

<span data-ttu-id="dfa41-104">Encontre informações sobre como usar a API gerenciada de EWS para se comunicar com o EWS no Exchange.</span><span class="sxs-lookup"><span data-stu-id="dfa41-104">Find information about how to use the EWS Managed API to communicate with EWS in Exchange.</span></span>
  
<span data-ttu-id="dfa41-105">A classe [ExchangeService](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.exchangeservice%28v=exchg.80%29.aspx) na API gerenciada do EWS contém os métodos e propriedades que você usa para definir as credenciais de usuário, identificar o ponto de extremidade do EWS, enviar e receber mensagens SOAP e configurar a ligação para se comunicar com o EWS.</span><span class="sxs-lookup"><span data-stu-id="dfa41-105">The [ExchangeService](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.exchangeservice%28v=exchg.80%29.aspx) class in the EWS Managed API contains the methods and properties that you use to set user credentials, identify the EWS endpoint, send and receive SOAP messages, and configure the binding to communicate with EWS.</span></span> <span data-ttu-id="dfa41-106">Antes de poder usar a API gerenciada de EWS para executar qualquer tarefa, você precisa criar uma instância da classe **ExchangeService** e vinculá-lo a EWS.</span><span class="sxs-lookup"><span data-stu-id="dfa41-106">Before you can use the EWS Managed API to perform any task, you have to create an instance of the **ExchangeService** class and bind it to EWS.</span></span> 
  
<span data-ttu-id="dfa41-107">Depois de configurar um objeto [ExchangeService](https://msdn.microsoft.com/library/Microsoft.Exchange.WebServices.Data.ExchangeService.aspx) com credenciais de usuário e o ponto de extremidade do EWS, qualquer objeto de caixa de correio que faz referência ao objeto [ExchangeService](https://msdn.microsoft.com/library/Microsoft.Exchange.WebServices.Data.ExchangeService.aspx) pode usar os seguintes tipos de método para se comunicar com o EWS:</span><span class="sxs-lookup"><span data-stu-id="dfa41-107">After you set up an [ExchangeService](https://msdn.microsoft.com/library/Microsoft.Exchange.WebServices.Data.ExchangeService.aspx) object with user credentials and the EWS endpoint, any mailbox object that references the [ExchangeService](https://msdn.microsoft.com/library/Microsoft.Exchange.WebServices.Data.ExchangeService.aspx) object can use the following method types to communicate with EWS:</span></span> 
  
- <span data-ttu-id="dfa41-108">Métodos do objeto ExchangeService — todos os métodos no objeto **ExchangeService** que não são herdados do tipo de **objeto** base fazem chamadas para o EWS.</span><span class="sxs-lookup"><span data-stu-id="dfa41-108">ExchangeService object methods — All the methods on the **ExchangeService** object that are not inherited from the base **Object** type make calls to EWS.</span></span> 
    
- <span data-ttu-id="dfa41-109">Métodos de tipo de item de caixa de correio do Exchange e pasta.</span><span class="sxs-lookup"><span data-stu-id="dfa41-109">Exchange mailbox item and folder type methods.</span></span>
    
<span data-ttu-id="dfa41-110">**Tabela 1. Item de caixa de correio e pasta Digite métodos que se comunicam com o EWS**</span><span class="sxs-lookup"><span data-stu-id="dfa41-110">**Table 1. Mailbox item and folder type methods that communicate with EWS**</span></span>

|<span data-ttu-id="dfa41-111">Método</span><span class="sxs-lookup"><span data-stu-id="dfa41-111">Method</span></span>|<span data-ttu-id="dfa41-112">O que ele faz</span><span class="sxs-lookup"><span data-stu-id="dfa41-112">What it does</span></span>|<span data-ttu-id="dfa41-113">Operações que ele chama</span><span class="sxs-lookup"><span data-stu-id="dfa41-113">Operations that it calls</span></span>|
|:-----|:-----|:-----|
|[<span data-ttu-id="dfa41-114">Load</span><span class="sxs-lookup"><span data-stu-id="dfa41-114">Load</span></span>](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.item.load%28v=exchg.80%29.aspx) <br/> |<span data-ttu-id="dfa41-115">Obtém as propriedades em um objeto de configuração do item, anexo ou usuário.</span><span class="sxs-lookup"><span data-stu-id="dfa41-115">Gets properties on an item, attachment, or user configuration object.</span></span>  <br/> |[<span data-ttu-id="dfa41-116">Operação GetItem</span><span class="sxs-lookup"><span data-stu-id="dfa41-116">GetItem operation</span></span>](http://msdn.microsoft.com/library/e3590b8b-c2a7-4dad-a014-6360197b68e4%28Office.15%29.aspx) <br/><br/> [<span data-ttu-id="dfa41-117">Operação GetAttachment</span><span class="sxs-lookup"><span data-stu-id="dfa41-117">GetAttachment operation</span></span>](http://msdn.microsoft.com/library/24d10a15-b942-415e-9024-a6375708f326%28Office.15%29.aspx) <br/><br/> [<span data-ttu-id="dfa41-118">Operação GetUserConfiguration</span><span class="sxs-lookup"><span data-stu-id="dfa41-118">GetUserConfiguration operation</span></span>](http://msdn.microsoft.com/library/71d50e3c-92bd-435f-8118-b28bb85f8138%28Office.15%29.aspx) <br/> |
|[<span data-ttu-id="dfa41-119">Vincular</span><span class="sxs-lookup"><span data-stu-id="dfa41-119">Bind</span></span>](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.item.bind%28v=exchg.80%29.aspx) <br/> |<span data-ttu-id="dfa41-120">Preenche um novo item no cliente com informações de um item existente no servidor.</span><span class="sxs-lookup"><span data-stu-id="dfa41-120">Populates a new item on the client with information from an existing item on the server.</span></span>  <br/> |[<span data-ttu-id="dfa41-121">Operação GetItem</span><span class="sxs-lookup"><span data-stu-id="dfa41-121">GetItem operation</span></span>](http://msdn.microsoft.com/library/e3590b8b-c2a7-4dad-a014-6360197b68e4%28Office.15%29.aspx) <br/> |
|[<span data-ttu-id="dfa41-122">Save</span><span class="sxs-lookup"><span data-stu-id="dfa41-122">Save</span></span>](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.item.save%28v=exchg.80%29.aspx) <br/> |<span data-ttu-id="dfa41-123">Salva a cópia do item cliente no servidor.</span><span class="sxs-lookup"><span data-stu-id="dfa41-123">Saves the copy of the client item on the server.</span></span>  <br/> |[<span data-ttu-id="dfa41-124">Operação UpdateItem</span><span class="sxs-lookup"><span data-stu-id="dfa41-124">UpdateItem operation</span></span>](http://msdn.microsoft.com/library/5d027523-e0bc-4da2-b60b-0cb9fc1fdfe4%28Office.15%29.aspx) <br/><br/> [<span data-ttu-id="dfa41-125">Operação UpdateFolder</span><span class="sxs-lookup"><span data-stu-id="dfa41-125">UpdateFolder operation</span></span>](http://msdn.microsoft.com/library/3494c996-b834-4813-b1ca-d99642d8b4e7%28Office.15%29.aspx) <br/><br/>[<span data-ttu-id="dfa41-126">Operação CreateItem</span><span class="sxs-lookup"><span data-stu-id="dfa41-126">CreateItem operation</span></span>](http://msdn.microsoft.com/library/78a52120-f1d0-4ed7-8748-436e554f75b6%28Office.15%29.aspx) <br/><br/>[<span data-ttu-id="dfa41-127">Operação CreateFolder</span><span class="sxs-lookup"><span data-stu-id="dfa41-127">CreateFolder operation</span></span>](http://msdn.microsoft.com/library/6f6c334c-b190-4e55-8f0a-38f2a018d1b3%28Office.15%29.aspx) <br/> |
|[<span data-ttu-id="dfa41-128">Update</span><span class="sxs-lookup"><span data-stu-id="dfa41-128">Update</span></span>](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.item.update%28v=exchg.80%29.aspx) <br/> |<span data-ttu-id="dfa41-129">Atualiza o servidor com as alterações feitas no cliente.</span><span class="sxs-lookup"><span data-stu-id="dfa41-129">Updates the server with the changes made on the client.</span></span><br/><br/><span data-ttu-id="dfa41-130">Para itens e pastas, o método **Update** usa a [operação UpdateItem](http://msdn.microsoft.com/library/5d027523-e0bc-4da2-b60b-0cb9fc1fdfe4%28Office.15%29.aspx) e a [operação UpdateFolder](http://msdn.microsoft.com/library/3494c996-b834-4813-b1ca-d99642d8b4e7%28Office.15%29.aspx).</span><span class="sxs-lookup"><span data-stu-id="dfa41-130">For items and folders, the **Update** method uses the [UpdateItem operation](http://msdn.microsoft.com/library/5d027523-e0bc-4da2-b60b-0cb9fc1fdfe4%28Office.15%29.aspx) and the [UpdateFolder operation](http://msdn.microsoft.com/library/3494c996-b834-4813-b1ca-d99642d8b4e7%28Office.15%29.aspx).</span></span>  <br/> |[<span data-ttu-id="dfa41-131">Operação UpdateItem</span><span class="sxs-lookup"><span data-stu-id="dfa41-131">UpdateItem operation</span></span>](http://msdn.microsoft.com/library/5d027523-e0bc-4da2-b60b-0cb9fc1fdfe4%28Office.15%29.aspx) <br/><br/>[<span data-ttu-id="dfa41-132">Operação UpdateFolder</span><span class="sxs-lookup"><span data-stu-id="dfa41-132">UpdateFolder operation</span></span>](http://msdn.microsoft.com/library/3494c996-b834-4813-b1ca-d99642d8b4e7%28Office.15%29.aspx) <br/> |
|[<span data-ttu-id="dfa41-133">Delete</span><span class="sxs-lookup"><span data-stu-id="dfa41-133">Delete</span></span>](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.item.delete%28v=exchg.80%29.aspx) <br/> |<span data-ttu-id="dfa41-134">Exclui um item no servidor.</span><span class="sxs-lookup"><span data-stu-id="dfa41-134">Deletes an item on the server.</span></span><br/><br/><span data-ttu-id="dfa41-135">Para itens e pastas, o método **Delete** usa o e a [operação DeleteFolder](http://msdn.microsoft.com/library/b0f92682-4895-4bcf-a4a1-e4c2e8403979%28Office.15%29.aspx).</span><span class="sxs-lookup"><span data-stu-id="dfa41-135">For items and folders, the **Delete** method uses the and the [DeleteFolder operation](http://msdn.microsoft.com/library/b0f92682-4895-4bcf-a4a1-e4c2e8403979%28Office.15%29.aspx).</span></span>  <br/> |[<span data-ttu-id="dfa41-136">Operação DeleteItem</span><span class="sxs-lookup"><span data-stu-id="dfa41-136">DeleteItem operation</span></span>](http://msdn.microsoft.com/library/3e26c416-fa12-476e-bfd2-5c1f4bb7b348%28Office.15%29.aspx) <br/><br/> [<span data-ttu-id="dfa41-137">Operação DeleteFolder</span><span class="sxs-lookup"><span data-stu-id="dfa41-137">DeleteFolder operation</span></span>](http://msdn.microsoft.com/library/b0f92682-4895-4bcf-a4a1-e4c2e8403979%28Office.15%29.aspx) <br/> |
|[<span data-ttu-id="dfa41-138">Copiar</span><span class="sxs-lookup"><span data-stu-id="dfa41-138">Copy</span></span>](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.item.copy%28v=exchg.80%29.aspx) <br/> |<span data-ttu-id="dfa41-139">Cria uma cópia do item ou pastas no servidor.</span><span class="sxs-lookup"><span data-stu-id="dfa41-139">Creates a copy of the item or folders on the server.</span></span>  <br/> |[<span data-ttu-id="dfa41-140">Operação CopyItem</span><span class="sxs-lookup"><span data-stu-id="dfa41-140">CopyItem operation</span></span>](http://msdn.microsoft.com/library/bcc68f9e-d511-4c29-bba6-ed535524624a%28Office.15%29.aspx) <br/><br/> [<span data-ttu-id="dfa41-141">Operação CopyFolder</span><span class="sxs-lookup"><span data-stu-id="dfa41-141">CopyFolder operation</span></span>](http://msdn.microsoft.com/library/c7ea0d68-9793-4144-b378-d99536776db9%28Office.15%29.aspx) <br/> |
|[<span data-ttu-id="dfa41-142">Mover</span><span class="sxs-lookup"><span data-stu-id="dfa41-142">Move</span></span>](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.item.move%28v=exchg.80%29.aspx) <br/> |<span data-ttu-id="dfa41-143">Move itens ou pastas no servidor.</span><span class="sxs-lookup"><span data-stu-id="dfa41-143">Moves items or folders on the server.</span></span>  <br/> |[<span data-ttu-id="dfa41-144">Operação MoveItem</span><span class="sxs-lookup"><span data-stu-id="dfa41-144">MoveItem operation</span></span>](http://msdn.microsoft.com/library/dcf40fa7-7796-4a5c-bf5b-7a509a18d208%28Office.15%29.aspx) <br/><br/> [<span data-ttu-id="dfa41-145">Operação MoveFolder</span><span class="sxs-lookup"><span data-stu-id="dfa41-145">MoveFolder operation</span></span>](http://msdn.microsoft.com/library/c7233966-6c87-4a14-8156-b1610760176d%28Office.15%29.aspx) <br/> |
   
## <a name="to-use-the-ews-managed-api-to-communicate-with-ews"></a><span data-ttu-id="dfa41-146">Usar a API gerenciada de EWS para se comunicar com o EWS</span><span class="sxs-lookup"><span data-stu-id="dfa41-146">To use the EWS Managed API to communicate with EWS</span></span>

1. <span data-ttu-id="dfa41-147">Criar uma instância da classe **ExchangeService** .</span><span class="sxs-lookup"><span data-stu-id="dfa41-147">Instantiate the **ExchangeService** class.</span></span> 
    
   ```csharp
    ExchangeService service = new ExchangeService();
   ```

   > [!NOTE]
   > <span data-ttu-id="dfa41-148">Instanciação **ExchangeService** com um construtor vazio criará uma instância que está acoplada a última versão conhecida do Exchange.</span><span class="sxs-lookup"><span data-stu-id="dfa41-148">Instantiating **ExchangeService** with an empty constructor will create an instance that is bound to the latest known version of Exchange.</span></span> <span data-ttu-id="dfa41-149">Como alternativa, é possível direcionar uma versão específica do Exchange, especificando a versão como um parâmetro.</span><span class="sxs-lookup"><span data-stu-id="dfa41-149">Alternatively, you can target a specific version of Exchange by specifying version as a parameter.</span></span> `ExchangeService service = new ExchangeService(ExchangeVersion.Exchange2007_SP1);`
  
2. <span data-ttu-id="dfa41-150">Defina as credenciais do usuário que enviar solicitações para o Exchange server.</span><span class="sxs-lookup"><span data-stu-id="dfa41-150">Set the credentials of the user who sends requests to the Exchange server.</span></span> <span data-ttu-id="dfa41-151">Se você deseja se conectar ao EWS de um computador que está conectado ao domínio, usando as credenciais do usuário autenticado, defina a propriedade **UseDefaultCredentials** no objeto **ExchangeService** como **true**.</span><span class="sxs-lookup"><span data-stu-id="dfa41-151">If you want to connect to EWS from a computer that is logged on to the domain, using the credentials of the authenticated user, set the **UseDefaultCredentials** property on the **ExchangeService** object to **true**.</span></span>
    
   ```cs
    // Connect by using the default credentials of the authenticated user.
    service.UseDefaultCredentials = true;
   ```

   <span data-ttu-id="dfa41-152">Se não desejar conectar usando as credenciais de usuário padrão, defina a propriedade de **credenciais** no objeto **ExchangeService** para especificar explicitamente as credenciais de um usuário diferente.</span><span class="sxs-lookup"><span data-stu-id="dfa41-152">If you do not want to connect by using the default user credentials, set the **Credentials** property on the **ExchangeService** object to explicitly specify the credentials of a different user.</span></span> <span data-ttu-id="dfa41-153">Se você estiver usando o Exchange Online ou Exchange Online como parte do Office 365, você usará a autenticação básica, com apenas um nome de usuário e uma senha.</span><span class="sxs-lookup"><span data-stu-id="dfa41-153">If you are using Exchange Online or Exchange Online as part of Office 365, you'll use basic authentication, with just a user name and password.</span></span> <span data-ttu-id="dfa41-154">Um nome de domínio é necessário para a autenticação NTLM.</span><span class="sxs-lookup"><span data-stu-id="dfa41-154">A domain name is required for NTLM authentication.</span></span> 
    
   ```cs
    // Connect by using the credentials of user1 at contoso.com.
    service.Credentials = new WebCredentials("user1@contoso.com", "password");
   ```

   <span data-ttu-id="dfa41-155">Você também pode especificar as credenciais do usuário usando o nome de domínio do usuário e senha.</span><span class="sxs-lookup"><span data-stu-id="dfa41-155">You can also specify the credentials of the user by using the user's domain name and password.</span></span>
    
   ```cs
    // Connect by using the credentials of contoso/user1.
    service.Credentials = new WebCredentials("user1", "password", "contoso");
   ```

   > [!NOTE]
   > <span data-ttu-id="dfa41-156">Se a propriedade **UseDefaultCredentials** estiver definida como **true**, o valor da propriedade **credenciais** será ignorado.</span><span class="sxs-lookup"><span data-stu-id="dfa41-156">If the **UseDefaultCredentials** property is set to **true**, the value of the **Credentials** property is ignored.</span></span> 
  
3. <span data-ttu-id="dfa41-157">Defina a URL do ponto de extremidade do EWS.</span><span class="sxs-lookup"><span data-stu-id="dfa41-157">Set the URL of the EWS endpoint.</span></span> <span data-ttu-id="dfa41-158">Essa URL localiza o arquivo de exchange.asmx no servidor de acesso para cliente.</span><span class="sxs-lookup"><span data-stu-id="dfa41-158">This URL locates the exchange.asmx file on Client Access server.</span></span>
    
   ```cs
    // Use Autodiscover to set the URL endpoint.
    service.AutodiscoverUrl("user1@contoso.com");
   ```

   > [!NOTE]
   >  <span data-ttu-id="dfa41-159">Embora você pode definir a propriedade **Url** do **ExchangeService** explicitamente como um valor de atributos, recomendamos que você use o serviço Descoberta automática em vez disso, pelos seguintes motivos: > descoberta automática determina o ponto de extremidade recomendado para um determinado usuário (o ponto de extremidade mais próximo ao servidor de caixa de correio do usuário).</span><span class="sxs-lookup"><span data-stu-id="dfa41-159">Although you can explicitly set the **Url** property of the **ExchangeService** to a hardcoded value, we recommend that you use the Autodiscover service instead, for the following reasons: >  Autodiscover determines the best endpoint for a given user (the endpoint that is closest to the user's Mailbox server).</span></span> <span data-ttu-id="dfa41-160">> A URL do EWS pode ser alterados se novos servidores de acesso para cliente forem implantados.</span><span class="sxs-lookup"><span data-stu-id="dfa41-160">>  The EWS URL might change if new Client Access servers are deployed.</span></span> <span data-ttu-id="dfa41-161">Neste cenário, usando a [descoberta automática](autodiscover-for-exchange.md) significa que nenhuma alteração de código é necessárias.</span><span class="sxs-lookup"><span data-stu-id="dfa41-161">In this scenario, using [Autodiscover](autodiscover-for-exchange.md) means no code changes are necessary.</span></span> <span data-ttu-id="dfa41-162">> Você deve definir a URL explicitamente ou chamada **AutodiscoverUrl**, mas você não deve fazer ambos.</span><span class="sxs-lookup"><span data-stu-id="dfa41-162">>  You should either set the URL explicitly or call **AutodiscoverUrl**, but you should not do both.</span></span> 
  
## <a name="see-also"></a><span data-ttu-id="dfa41-163">Confira também</span><span class="sxs-lookup"><span data-stu-id="dfa41-163">See also</span></span>

- [<span data-ttu-id="dfa41-164">Introdução aos aplicativos de cliente API gerenciada de EWS</span><span class="sxs-lookup"><span data-stu-id="dfa41-164">Get started with EWS Managed API client applications</span></span>](get-started-with-ews-managed-api-client-applications.md) 
- [<span data-ttu-id="dfa41-165">Usar descoberta automática para encontrar os pontos de conexão</span><span class="sxs-lookup"><span data-stu-id="dfa41-165">Use Autodiscover to find connection points</span></span>](how-to-use-autodiscover-to-find-connection-points.md)   
- [<span data-ttu-id="dfa41-166">Develop web service clients for Exchange</span><span class="sxs-lookup"><span data-stu-id="dfa41-166">Develop web service clients for Exchange</span></span>](develop-web-service-clients-for-exchange.md)
    

