---
title: Gravador do Exchange no Exchange 2013
manager: sethgros
ms.date: 09/17/2015
ms.audience: Developer
ms.topic: overview
ms.prod: office-online-server
localization_priority: Normal
ms.assetid: ec126433-9f0a-46ec-a685-ff4af2f97bc1
description: Encontre informações sobre o autor do Exchange no Exchange 2013 para backup e restauração das operações.
ms.openlocfilehash: a4dc5963ab24a83969efc6e425b38a35276f3aa3
ms.sourcegitcommit: 34041125dc8c5f993b21cebfc4f8b72f0fd2cb6f
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 06/11/2018
ms.locfileid: "19750626"
---
# <a name="exchange-writer-in-exchange-2013"></a><span data-ttu-id="a147b-103">Gravador do Exchange no Exchange 2013</span><span class="sxs-lookup"><span data-stu-id="a147b-103">Exchange writer in Exchange 2013</span></span>

<span data-ttu-id="a147b-104">Encontre informações sobre o autor do Exchange no Exchange 2013 para backup e restauração das operações.</span><span class="sxs-lookup"><span data-stu-id="a147b-104">Find information about the Exchange writer in Exchange 2013 for backup and restore operations.</span></span> 
  
<span data-ttu-id="a147b-105">**Aplica-se a:** Exchange Server 2013</span><span class="sxs-lookup"><span data-stu-id="a147b-105">**Applies to:** Exchange Server 2013</span></span> 
  
<span data-ttu-id="a147b-106">O gravador do Exchange é responsável pelo backup e restauração de bancos de dados ativos do Exchange Server 2013.</span><span class="sxs-lookup"><span data-stu-id="a147b-106">The Exchange writer is responsible for the backup and restore of active Exchange Server 2013 databases.</span></span> <span data-ttu-id="a147b-107">O gravador do Exchange também dá suporte à funcionalidade de backup para um banco de dados selecionado, onde a cópia de sombra é colocada em relação à instância replicada do banco de dados e transações arquivos de log.</span><span class="sxs-lookup"><span data-stu-id="a147b-107">The Exchange writer also supports backup functionality for a selected database where the shadow copy is taken against the replicated instance of the database and transaction log files.</span></span> 
  
## <a name="overview-of-the-exchange-writer"></a><span data-ttu-id="a147b-108">Visão geral do gravador do Exchange</span><span class="sxs-lookup"><span data-stu-id="a147b-108">Overview of the Exchange writer</span></span>
<span data-ttu-id="a147b-109"><a name="bk_Overview"> </a></span><span class="sxs-lookup"><span data-stu-id="a147b-109"></span></span>

<span data-ttu-id="a147b-110">Exchange 2013 inclui recursos de mobilidade de banco de dados, que permitem a bancos de dados a serem replicadas entre os servidores Exchange diferentes para melhorar a disponibilidade de banco de dados e resiliência do site.</span><span class="sxs-lookup"><span data-stu-id="a147b-110">Exchange 2013 includes database mobility features, which enable databases to be replicated among different Exchange servers to improve database availability and site resilience.</span></span> <span data-ttu-id="a147b-111">As outras cópias de banco de dados em um grupo de disponibilidade do banco de dados (DAG) fornecem uma oportunidade valiosa para fazer backups do Exchange usar os recursos adicionais que estão disponíveis no local da cópia.</span><span class="sxs-lookup"><span data-stu-id="a147b-111">The other database copies in a Database Availability Group (DAG) provide a valuable opportunity for Exchange backups to use the extra resources that are available at the copy location.</span></span> <span data-ttu-id="a147b-112">Além disso, porque a cópia em vez do mestre de banco de dados ativo é feita o backup, a cópia pode ser indisponível durante o backup para um período de tempo maior.</span><span class="sxs-lookup"><span data-stu-id="a147b-112">In addition, because the copy instead of the active database master is backed up, the copy can be unavailable during the backup for a longer period of time.</span></span> 
  
<span data-ttu-id="a147b-113">O gravador do Exchange coordena com os serviços do Exchange (operacional em nome do solicitante) para preparar os arquivos de banco de dados para fazer backups, congelar a atividade de e/s resultante de transações do Exchange antes do backup do banco de dados e descongelar e truncar arquivos de log após o backup for concluído.</span><span class="sxs-lookup"><span data-stu-id="a147b-113">The Exchange writer coordinates with the Exchange services (operating on behalf of the requester) to prepare the database files for backups, freeze the IO activity resulting from Exchange transactions before backing up the database, and then unfreeze and truncate log files after the backup is complete.</span></span>
  
<span data-ttu-id="a147b-114">Durante uma recuperação, o seu aplicativo de backup e restauração instrui o gravador do Exchange para coordenar com o repositório do Exchange (operacional em nome do solicitante) para verificar os destinos de restauração, renomeie o arquivo de banco de dados, se necessário e, em seguida, repetição durante a transação logs conforme necessário.</span><span class="sxs-lookup"><span data-stu-id="a147b-114">During a restore, your backup and restore application instructs the Exchange writer to coordinate with the Exchange store (operating on behalf of the requester) to verify the restore targets, rename the database file if necessary, and then replay the transaction logs as needed.</span></span> <span data-ttu-id="a147b-115">O gravador do Exchange oferece suporte a backups e restaurações.</span><span class="sxs-lookup"><span data-stu-id="a147b-115">The Exchange writer supports both backups and restores.</span></span>
  
<span data-ttu-id="a147b-116">O gravador do Exchange está disponível em qualquer servidor do Exchange que possui a função de servidor de caixa de correio instalada.</span><span class="sxs-lookup"><span data-stu-id="a147b-116">The Exchange writer is available on any Exchange server that has the Mailbox server role installed.</span></span> 
  
## <a name="exchange-writer-configuration-settings"></a><span data-ttu-id="a147b-117">Definições de configuração do Exchange gravador</span><span class="sxs-lookup"><span data-stu-id="a147b-117">Exchange writer configuration settings</span></span>
<span data-ttu-id="a147b-118"><a name="bk_ExchangeWriterConfig"> </a></span><span class="sxs-lookup"><span data-stu-id="a147b-118"></span></span>

<span data-ttu-id="a147b-119">O gravador VSS do Exchange usa uma variedade de configurações e valores que devem ser definidos corretamente e preservados durante operações de backup e restauração.</span><span class="sxs-lookup"><span data-stu-id="a147b-119">The Exchange writer for VSS uses a variety of settings and values that must be set correctly and preserved during backup and restore operations.</span></span> <span data-ttu-id="a147b-120">Essas definições de configuração são armazenadas no documento de metadados do gravador do Exchange.</span><span class="sxs-lookup"><span data-stu-id="a147b-120">These configuration settings are stored in the Exchange writer metadata document.</span></span> <span data-ttu-id="a147b-121">Se seu aplicativo de backup não preservar a essas configurações, você pode sofrer erros inesperados quando você tenta fazer backup de seus bancos de dados do Exchange.</span><span class="sxs-lookup"><span data-stu-id="a147b-121">If your backup application does not preserve these settings, you might experience unexpected errors when you attempt to back up your Exchange databases.</span></span> 
  
<span data-ttu-id="a147b-122">A tabela a seguir lista as interfaces VSS que exponham metadados sobre os componentes do seu backup do banco de dados.</span><span class="sxs-lookup"><span data-stu-id="a147b-122">The following table lists the VSS interfaces that expose metadata about the components of your database backup.</span></span> <span data-ttu-id="a147b-123">Essas interfaces são necessárias para obter o gravador do Exchange documento de metadados que é usado para realizar um backup do repositório do Exchange.</span><span class="sxs-lookup"><span data-stu-id="a147b-123">These interfaces are required to get the Exchange writer metadata document that is used to perform a backup of the Exchange store.</span></span>
  
<span data-ttu-id="a147b-124">**Tabela 1. Interfaces VSS**</span><span class="sxs-lookup"><span data-stu-id="a147b-124">**Table 1. VSS interfaces**</span></span>

|<span data-ttu-id="a147b-125">**Interface VSS**</span><span class="sxs-lookup"><span data-stu-id="a147b-125">**VSS interface**</span></span>|<span data-ttu-id="a147b-126">**Descrição**</span><span class="sxs-lookup"><span data-stu-id="a147b-126">**Description**</span></span>|
|:-----|:-----|
|<span data-ttu-id="a147b-127">IVssWMComponent</span><span class="sxs-lookup"><span data-stu-id="a147b-127">IVssWMComponent</span></span>  <br/> |<span data-ttu-id="a147b-128">Permite o acesso às informações de componente armazenadas no gravador do Exchange.</span><span class="sxs-lookup"><span data-stu-id="a147b-128">Allows access to component information stored in the Exchange writer.</span></span>  <br/> |
|<span data-ttu-id="a147b-129">IVssExamineWriterMetadata</span><span class="sxs-lookup"><span data-stu-id="a147b-129">IVssExamineWriterMetadata</span></span>  <br/> |<span data-ttu-id="a147b-130">Permite que o aplicativo solicitante de backup e restauração examinar os metadados do gravador do Exchange.</span><span class="sxs-lookup"><span data-stu-id="a147b-130">Allows the requesting backup and restore application to examine the metadata of the Exchange writer.</span></span> <span data-ttu-id="a147b-131">O documento de metadados do gravador Exchange contém valores específicos do Exchange 2013 e os parâmetros que requer que o aplicativo de backup e restauração de solicitação para que ele possa especificar corretamente os componentes apropriados para o backup.</span><span class="sxs-lookup"><span data-stu-id="a147b-131">The Exchange writer metadata document contains Exchange 2013-specific values and parameters that the requesting backup and restore application requires so that it can correctly specify the appropriate components for backup.</span></span>  <br/> |
|<span data-ttu-id="a147b-132">IVssComponent</span><span class="sxs-lookup"><span data-stu-id="a147b-132">IVssComponent</span></span>  <br/> |<span data-ttu-id="a147b-133">Contém métodos para examinar e modificar informações sobre os componentes contidos no documento de componentes de Backup de um solicitante.</span><span class="sxs-lookup"><span data-stu-id="a147b-133">Contains methods for examining and modifying information about components contained in a requester's Backup Components Document.</span></span> <span data-ttu-id="a147b-134">Objetos só podem ser obtidos para esses componentes que tenham sido adicionados explicitamente a este documento pelo método [IVssBackupComponents::AddComponent](http://msdn.microsoft.com/en-us/library/windows/desktop/aa382646%28v=vs.85%29.aspx) .</span><span class="sxs-lookup"><span data-stu-id="a147b-134">Objects can only be obtained for those components that have been explicitly added to this document by the [IVssBackupComponents::AddComponent](http://msdn.microsoft.com/en-us/library/windows/desktop/aa382646%28v=vs.85%29.aspx) method.</span></span>  <br/> |
|<span data-ttu-id="a147b-135">IVssBackupComponents</span><span class="sxs-lookup"><span data-stu-id="a147b-135">IVssBackupComponents</span></span>  <br/> |<span data-ttu-id="a147b-136">Usado pelo aplicativo de backup e restauração solicitante para sondar o gravador do Exchange sobre o status do arquivo e para executar o backup e operações de restauração.</span><span class="sxs-lookup"><span data-stu-id="a147b-136">Used by the requesting backup and restore application to poll the Exchange writer about file status and to run backup and restore operations.</span></span> <span data-ttu-id="a147b-137">O método [IVssBackupComponents::SetBackupState](http://msdn.microsoft.com/en-us/library/windows/desktop/aa382833%28v=vs.85%29.aspx) define se a operação de backup é uma cópia completa, incremental, ou o backup diferencial.</span><span class="sxs-lookup"><span data-stu-id="a147b-137">The [IVssBackupComponents::SetBackupState ](http://msdn.microsoft.com/en-us/library/windows/desktop/aa382833%28v=vs.85%29.aspx) method defines whether the backup operation is a full, copy, incremental, or differential backup.</span></span> <span data-ttu-id="a147b-138">O método [IVssBackupComponents::AddRestoreSubcomponent](http://msdn.microsoft.com/en-us/library/windows/desktop/aa382649%28v=vs.85%29.aspx) define os subcomponentes de um banco de dados do Exchange 2013 que podem ser selecionados para uma operação de restauração.</span><span class="sxs-lookup"><span data-stu-id="a147b-138">The [IVssBackupComponents::AddRestoreSubcomponent](http://msdn.microsoft.com/en-us/library/windows/desktop/aa382649%28v=vs.85%29.aspx) method defines the subcomponents of an Exchange 2013 database that can be selected for a restore operation.</span></span>  <br/> |
   
<span data-ttu-id="a147b-139">Dentro do sistema de arquivo do Windows Server, um banco de dados do Exchange 2013 é armazenado como um arquivo de banco de dados único com uma extensão *. edb. O gravador do Exchange expõe a *. edb como o componente de banco de dados, enquanto os logs de transações (*. log) e arquivos de ponto de verificação (*. chk) são combinados em um único componente, conhecido como o componente de log.</span><span class="sxs-lookup"><span data-stu-id="a147b-139">Within the Windows Server file system, an Exchange 2013 database is stored as a single database file with an extension *.edb. The Exchange writer exposes the *.edb as the database component, while transaction logs (*.log) and checkpoint files (*.chk) are combined into a single component, referred to as the log component.</span></span> <span data-ttu-id="a147b-140">Para obter mais informações sobre arquivos de banco de dados do Exchange, consulte [conceitos de Backup e restauração do Exchange 2013](backup-and-restore-concepts-for-exchange-2013.md).</span><span class="sxs-lookup"><span data-stu-id="a147b-140">For more information about Exchange database files, see [Backup and restore concepts for Exchange 2013](backup-and-restore-concepts-for-exchange-2013.md).</span></span>
  
## <a name="interactions-between-the-exchange-writer-vss-and-vss-requesters"></a><span data-ttu-id="a147b-141">Interações entre o Exchange gravador VSS e VSS solicitantes</span><span class="sxs-lookup"><span data-stu-id="a147b-141">Interactions between the Exchange writer, VSS, and VSS requesters</span></span>
<span data-ttu-id="a147b-142"><a name="bk_interactions"> </a></span><span class="sxs-lookup"><span data-stu-id="a147b-142"></span></span>

<span data-ttu-id="a147b-143">A interação de alto nível entre o VSS, o gravador do Exchange, e Exchange 2013 durante operações de backup é da seguinte maneira:</span><span class="sxs-lookup"><span data-stu-id="a147b-143">The high-level interaction between the VSS, the Exchange writer, and Exchange 2013 during backup operations is as follows:</span></span>
  
1. <span data-ttu-id="a147b-144">O programa de backup (ou agente) executa um trabalho agendado.</span><span class="sxs-lookup"><span data-stu-id="a147b-144">The backup program (or agent) runs a scheduled job.</span></span> 
    
2. <span data-ttu-id="a147b-145">O solicitante VSS no aplicativo de backup e restauração envia um comando ao VSS para fazer uma cópia de sombra do bancos de dados selecionados do Exchange 2013.</span><span class="sxs-lookup"><span data-stu-id="a147b-145">The VSS requester in the backup and restore application sends a command to VSS to take a shadow copy of the selected Exchange 2013 databases.</span></span> 
    
3. <span data-ttu-id="a147b-146">VSS se comunica com o gravador do Exchange para se preparar para um backup de instantâneo.</span><span class="sxs-lookup"><span data-stu-id="a147b-146">VSS communicates with the Exchange writer to prepare for a snapshot backup.</span></span> <span data-ttu-id="a147b-147">Exchange 2013 proíbe ações administrativas contra os bancos de dados, verifica as dependências de volume e suspende todas as operações de gravação para a instância selecionada dos arquivos de log de banco de dados e transações enquanto permite acesso somente leitura.</span><span class="sxs-lookup"><span data-stu-id="a147b-147">Exchange 2013 prohibits administrative actions against the databases, checks volume dependencies, and suspends all write operations to selected instance of the database and transaction log files while allowing read-only access.</span></span> 
    
4. <span data-ttu-id="a147b-148">VSS se comunica com o provedor de armazenamento apropriado para criar uma cópia de sombra de volume de armazenamento que contém os bancos de dados do Exchange 2013.</span><span class="sxs-lookup"><span data-stu-id="a147b-148">VSS communicates with the appropriate storage provider to create a shadow copy of the storage volume that contains the Exchange 2013 databases.</span></span> 
    
5. <span data-ttu-id="a147b-149">VSS libera o Exchange 2013 para retomar as operações comuns.</span><span class="sxs-lookup"><span data-stu-id="a147b-149">VSS releases Exchange 2013 to resume ordinary operations.</span></span> 
    
6. <span data-ttu-id="a147b-150">O solicitante VSS verifica a consistência física do conjunto antes que o backup foi bem-sucedida de sinalização de backup.</span><span class="sxs-lookup"><span data-stu-id="a147b-150">The VSS requester verifies the physical consistency of the backup set prior to signaling that the backup was successful.</span></span> <span data-ttu-id="a147b-151">Exchange 2013 trunca os logs de transações (se o banco de dados for parte de um DAG, truncamento de log é replicado entre todas as cópias) e a hora do último backup do banco de dados de registros.</span><span class="sxs-lookup"><span data-stu-id="a147b-151">Exchange 2013 truncates the transaction logs (if the database is part of a DAG, log truncation is replicated among all the copies) and records the time of the last backup for the database.</span></span>
    
<span data-ttu-id="a147b-152">VSS serializa a interação dos solicitantes com o gravador do Exchange, começando com o método [OnPrepareBackup](http://msdn.microsoft.com/en-us/library/windows/desktop/aa381571%28v=vs.85%29.aspx) e terminando com o método [OnPostSnapshot](http://msdn.microsoft.com/en-us/library/windows/desktop/aa381568%28v=vs.85%29.aspx) .</span><span class="sxs-lookup"><span data-stu-id="a147b-152">VSS serializes requesters' interaction with the Exchange writer starting with the [OnPrepareBackup](http://msdn.microsoft.com/en-us/library/windows/desktop/aa381571%28v=vs.85%29.aspx) method and ending with the [OnPostSnapshot](http://msdn.microsoft.com/en-us/library/windows/desktop/aa381568%28v=vs.85%29.aspx) method.</span></span> <span data-ttu-id="a147b-153">Normalmente, a maior parte do tempo que o autor do Exchange gasta como trabalhar com a cópia de sombra ocorre após o método **OnPostSnapshot** , quando a consistência da cópia de sombra é verificada antes da conclusão dos backups.</span><span class="sxs-lookup"><span data-stu-id="a147b-153">Typically, the majority of time the Exchange writer spends working with the shadow copy occurs after the **OnPostSnapshot** method, when the consistency of the shadow copy is verified prior to completion of the backups.</span></span> <span data-ttu-id="a147b-154">O gravador do Exchange oferece suporte a backups paralelos entre **OnPostSnapshot** e [OnBackupComplete](http://msdn.microsoft.com/en-us/library/windows/desktop/aa381557%28v=vs.85%29.aspx).</span><span class="sxs-lookup"><span data-stu-id="a147b-154">The Exchange writer supports parallel backups between **OnPostSnapshot** and [OnBackupComplete](http://msdn.microsoft.com/en-us/library/windows/desktop/aa381557%28v=vs.85%29.aspx).</span></span>
  
<span data-ttu-id="a147b-155">Exchange 2013 não permite backups simultâneos do mesmo banco de dados.</span><span class="sxs-lookup"><span data-stu-id="a147b-155">Exchange 2013 does not allow concurrent backups of the same database.</span></span> <span data-ttu-id="a147b-156">Somente um trabalho de backup pode executar em relação a um determinado banco de dados de uma só vez.</span><span class="sxs-lookup"><span data-stu-id="a147b-156">Only one backup job can run against a given database at one time.</span></span> <span data-ttu-id="a147b-157">Quando o backup estiver sendo executado, o armazenamento do Exchange coloca o banco de dados em um estado de backup em andamento.</span><span class="sxs-lookup"><span data-stu-id="a147b-157">When the backup is running, the Exchange store puts the database in a backup-in-progress state.</span></span> <span data-ttu-id="a147b-158">Nesse estado na memória está desmarcado tanto na conclusão do processo de backup ou quando o serviço for reiniciado.</span><span class="sxs-lookup"><span data-stu-id="a147b-158">This in-memory state is cleared either at the completion of the backup process or when the service is restarted.</span></span> <span data-ttu-id="a147b-159">O estado de backup em andamento na memória e seus dados associados são perdidas quando o serviço que hospeda o gravador do Exchange for reiniciado, quando o sistema operacional for reiniciado, ou quando ocorre um failover de cluster.</span><span class="sxs-lookup"><span data-stu-id="a147b-159">The in-memory backup-in-progress state and its associated data are lost when the service that hosts the Exchange writer is restarted, when the operating system is restarted, or when a cluster failover occurs.</span></span> <span data-ttu-id="a147b-160">Qualquer um desses eventos fará com que o trabalho de backup falha.</span><span class="sxs-lookup"><span data-stu-id="a147b-160">Any of these events will cause the backup job to fail.</span></span>
  
<span data-ttu-id="a147b-161">Truncamento de arquivo de log de transações iniciadas pelo backup é disparado com base no tipo de backup a ser executada.</span><span class="sxs-lookup"><span data-stu-id="a147b-161">Backup-initiated transaction log file truncation is triggered based on the type of backup to be performed.</span></span> <span data-ttu-id="a147b-162">Nas configurações não são DAG, o gravador do Exchange truncará os arquivos de log de transação na conclusão de backups completos ou incrementais bem-sucedidos.</span><span class="sxs-lookup"><span data-stu-id="a147b-162">In non-DAG configurations, the Exchange writer will truncate the transaction log files at the completion of successful full or incremental backups.</span></span> <span data-ttu-id="a147b-163">No DAG replicado configurações, truncamento de log será adiado pelo serviço de replicação até que todos os arquivos de log necessários serão repetidos em todas as outras cópias.</span><span class="sxs-lookup"><span data-stu-id="a147b-163">In DAG replicated configurations, log truncation will be delayed by the replication service until all necessary log files are replayed into all other copies.</span></span> <span data-ttu-id="a147b-164">O serviço de replicação excluirá a quais foi feito backup dos arquivos de log, que ambos da ativa e da cópia caminhos de arquivo de log depois que ele verifica se os arquivos de log tiverem sido aplicados com êxito para o banco de dados de cópia e ambos os banco de dados ativo e o ponto de verificação de cópias de banco de dados passou os arquivos de log a ser excluído.</span><span class="sxs-lookup"><span data-stu-id="a147b-164">The replication service will delete the backed up log files both from the active and the copy log file paths after it verifies that the log files have successfully been applied to the copy database and both active database and the database copies checkpoint has passed the log files to be deleted.</span></span>
  
## <a name="see-also"></a><span data-ttu-id="a147b-165">Confira também</span><span class="sxs-lookup"><span data-stu-id="a147b-165">See also</span></span>

- [<span data-ttu-id="a147b-166">Logs de transações e arquivos de ponto de verificação de backup e restauração no Exchange 2013</span><span class="sxs-lookup"><span data-stu-id="a147b-166">Transaction logs and checkpoint files for backup and restore in Exchange 2013</span></span>](transaction-logs-and-checkpoint-files-for-backup-and-restore-in-exchange.md)
    
- [<span data-ttu-id="a147b-167">Conceitos de backup e restauração do Exchange 2013</span><span class="sxs-lookup"><span data-stu-id="a147b-167">Backup and restore concepts for Exchange 2013</span></span>](backup-and-restore-concepts-for-exchange-2013.md)
    

